NVIDIA UVM(Unified Virtual Memory)
-------------------------------------------------------------

- The UVM architecture
    - Server-client architecture
    - Server: host driver serves as a runtime page fault servicing engine for all clients and the memory manager for managed memory allocation
    - Client: user-level GPU or host code
    - Any activate thread on the GPU can trigger a page fault
        - The page fault is recognized and handled by the hardware thread’s corresponding micro-TLB(each GPC has a private L1 micro-TLB)
        - The thread treats this scenario as any other outstanding memory request
    - GMMU propagates the fault
        - sends a hardware interrupt to the host
        - writes the fault information into the GPU Fault Buffer
        - The Fault Buffer acts as a circular array, configured and managed by the UVM driver
    - The UVM driver fetches the fault information, cache it on the host, and services the faults
    - The GPU exposed two functionalities to the host
        - the GPU command push-buffer —host-to-GPU memory copy
        - fault replay *[HPCA’16 Towards High Performance Paged Memory for GPUs]*
- Fault batching and handling
    - The nvidia-uvm driver groups outstanding faults into batches in the host-side cache
    - Fault delivery to the host requires two steps
        - The GPU sends an interrupt over the interconnect to alert the host UVM driver of a page fault
        - The host retrieves the fault information from the GPU fault buffer
    - The interrupt wakes up a worker thread if none are awake
    - The default fault retrieval policy is to read faults until the batch size limit(up to a maximum size of 256 faults)  is reached or no more faults remain in the buffer
    - UVM adopts the host OS’s page size for migration and tracking
        - 4KB pages for x86 and 64KB for Power9
        - Additional internal abstraction for management and performance consideration. For x86, pages are upgraded from 4KB to 64KB within UVM runtime as a component of prefetching
        - 2MB VABlock(Virtual Address Block) serves as logical boundaries and is a unit of eviction

